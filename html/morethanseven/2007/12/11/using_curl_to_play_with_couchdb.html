<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>Using Curl to play with CouchDB</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type' />
    <meta content='' name='keywords' />
    <link href='/assets/css/reset.css' rel='stylesheet' type='text/css' />
    <link href='/assets/css/style.css' media='screen' rel='stylesheet' type='text/css' />
    <link href='/assets/css/code.css' rel='stylesheet' type='text/css' />
  </head>
  <body>
    <div id='main'>
      <div id='header'>
        <div class='logo'>
          <a href='/'>&laquo; morethanseven</a>
        </div>
        <div id='nav'>
          <ul>
            <li><a href='/about.html'>about</a></li>
            <li><a href='/archives.html'>archives</a></li>
            <li><a href='/tags.html'>tags</a></li>
            <li>
              <a href='/atom.xml'>rss</a>
            </li>
          </ul>
        </div>
      </div>
      <div class='clear'></div>
      <div class='article'>
        <h1>
          Using Curl to play with CouchDB
        </h1>
        <div class='meta'>
          <ul class='tags'>
            <li>Dec 11, 2007</li>
            <li>&middot;</li>
          </ul>
        </div>
        <div class='body'>
          <p>As a big big fan of all things <span class="caps">HTTP</span>, the new <a href="http://www.erlang.org/">Erlang</a> based database, <a href="http://couchdb.org">CouchDB</a>, piqued my interest. With the recent <a href="http://damienkatz.net/2007/11/couchdb_070.html">release of 0.7</a> it&#8217;s now intended for widespread use. Now I&#8217;m a fan of databases as long as I don&#8217;t have to go too near them. <span class="caps">SQL</span>, triggers and stored procedures are all a little too close to magic for me.</p>
          <p>The reason CouchDB looks particularly good fun was it&#8217;s build around a <span class="caps">REST</span> <span class="caps">API</span> using <span class="caps">JSON</span> for data transport. I&#8217;m generally not an acronym guy, but <span class="caps">REST</span>, <span class="caps">JSON</span>, <span class="caps">API</span> and <span class="caps">HTTP</span> in one open source piece of code? Sounds like fun to me.</p>
          <p>The CouchDB community have built up an already <a href="http://www.couchdbwiki.com/">excellent wiki</a> with all the information you need to get started and get the <a href="http://www.couchdbwiki.com/index.php?title=Installation">software installed</a>. I just used the magic of <a href="http://www.macports.org/">MacPorts</a> but the page covers all the various dependencies and setups (though nothing on their yet about the N800).</p>
          <pre><code>sudo port install couchdb</code></pre>
          <p>You might then need to set-up a user and some permissions. Again the wiki has more <a href="http://www.couchdbwiki.com/index.php?title=Installation#Security_Considerations">detailed installation instructions</a>. All being well you should then be able to fire up CouchDB:</p>
          <pre><code>sudo -u couchdb couchdb</code></pre>
          <p>So first things first. Their are getting started code examples on the wiki in all the usual languages so you can just dive in. CouchDB also comes with a few in-build tools which are both pretty attractive and useful. You have a <a href="http://localhost:8888/_utils/browse/index.html">database browser</a>, a full <a href="http://localhost:8888/_utils/couch_tests.html">test suite</a> and a <a href="http://localhost:8888/_utils/shell.html">command shell</a>.</p>
          <p><a href="http://curl.haxx.se/">Curl</a>, for those not familiar with it, is a fantastic command line utility for throwing around <span class="caps">HTTP</span> requests. I already use it for testing and generally prodding sites but it&#8217;s absolutely perfect for demonstrating CouchDB. Let&#8217;s start with creating a database called <em>test</em>:</p>
          <pre><code>curl -X PUT http://localhost:8888/test/</code></pre>
          <p>That should have created the database. Let&#8217;s get some information back about the database:</p>
          <pre><code>curl -X GET http://localhost:8888/test/</code></pre>
          <p>Everything should be returning <span class="caps">JSON</span> strings telling us something about what it finds. Let&#8217;s add a blank document to the database:</p>
          <pre><code>curl -X POST http://localhost:8888/test/ \&#x000A;-H "Content-Type: application/json" -d {}</code></pre>
          <p>Note the blank <span class="caps">JSON</span> object <em>{}</em> passed as Post data. What about retrieving a list of document from the database?</p>
          <pre><code>curl -X GET http://localhost:8888/test/_all_docs</code></pre>
          <p>We&#8217;re now done with that database so let&#8217;s delete it.</p>
          <pre><code>curl -X DELETE http://localhost:8888/test/</code></pre>
          <p>I&#8217;ve just done the basics here, but the APIs are simple and nicely documented enough for you easily to find out more. This is the beauty of RESTfully designed APIs, they are just about self documenting. For the most part you just have a predefined <span class="caps">HTTP</span> method and a defined <span class="caps">URL</span>.</p>
          <ul>
          	<li><a href="http://www.couchdbwiki.com/index.php?title=HTTP_View_API"><span class="caps">HTTP</span> View <span class="caps">API</span></a></li>
          	<li><a href="http://www.couchdbwiki.com/index.php?title=HTTP_Doc_API"><span class="caps">HTTP</span> Doc <span class="caps">API</span></a></li>
          	<li><a href="http://www.couchdbwiki.com/index.php?title=HTTP_Db_API"><span class="caps">HTTP</span> DB <span class="caps">API</span></a></li>
          </ul>
          <p>The Erlang base of CouchDB makes for some interesting horizontal scaling possibilities (as well as a good excuse to play with Erlang.) Even if CouchDB wasn&#8217;t cool enough already, it comes with probably the best start-up message I&#8217;ve seen in software for ages:</p>
          <pre><code>CouchDB has started. Time to relax.</code></pre>
        </div>
      </div>
      <div id='other-articles'>
        <div class='older'>
          <ul>
            <li>
              <h3>
                <a href='/2007/12/08/writing_elsewhere.html' title=''>
                  &laquo; Writing Elsewhere
                </a>
              </h3>
            </li>
            <li>
              <h3>
                <a href='/2007/12/08/insert_dojo_and_yui_bookmarklets.html' title=''>
                  &laquo; Insert Dojo and YUI bookmarklets
                </a>
              </h3>
            </li>
            <li>
              <h3>
                <a href='/2007/12/03/debug_web_pages_with_jquery_and_jash.html' title=''>
                  &laquo; Debug web pages with Jquery and Jash
                </a>
              </h3>
            </li>
          </ul>
        </div>
        <div class='newer'>
          <ul>
            <li>
              <h3>
                <a href='/2007/12/17/css_uprising.html' title=''>
                  CSS Uprising &raquo;
                </a>
              </h3>
            </li>
            <li>
              <h3>
                <a href='/2007/12/23/happy_with_my_eeepc.html' title=''>
                  Happy with my eeepc &raquo;
                </a>
              </h3>
            </li>
            <li>
              <h3>
                <a href='/2007/12/26/nice_bits_of_symfony_web_debug_toolbar.html' title=''>
                  Nice bits of symfony: Web Debug Toolbar &raquo;
                </a>
              </h3>
            </li>
          </ul>
        </div>
      </div>
      <div class='clear'></div>
      <div class='clear'></div>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      //]]>
    </script>
    <script type='text/javascript'>
      //<![CDATA[
        try {
          var pageTracker = _gat._getTracker("UA-435455-1");
          pageTracker._setDomainName(".morethanseven.net");
          pageTracker._setAllowHash(false);
          pageTracker._trackPageview();
        } catch(err) {}
      //]]>
    </script>
  </body>
</html>
